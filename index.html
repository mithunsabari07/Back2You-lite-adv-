<!DOCTYPE html>
<html>
<head>
<title>Back2You Lite</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{font-family:Arial;background:#f2f2f2;padding:15px}
h1,h2{text-align:center}
input,button{width:100%;padding:10px;margin:6px 0;border-radius:6px;border:1px solid #ccc}
button{background:#007bff;color:white;border:none}
.section{background:#fff;padding:15px;border-radius:8px;margin-top:15px}
.card{border:1px solid #ccc;padding:10px;margin-top:10px;border-radius:6px}
.lost{background:#ffecec}
.found{background:#ecffec}
.suggest{background:#fff;border:1px solid #ccc}
.suggest div{padding:6px;cursor:pointer}
.suggest div:hover{background:#eee}
.edit{background:#28a745}
.del{background:#dc3545}
</style>
</head>

<body>

<h1>Back2You Lite</h1>

<!-- SEARCH LOST -->
<div class="section">
<h2>ğŸ” Search Lost Items</h2>
<input id="sLost" oninput="search('lost')" placeholder="Search lost item">
<div id="sgLost" class="suggest"></div>
</div>

<!-- SEARCH FOUND -->
<div class="section">
<h2>ğŸ” Search Found Items</h2>
<input id="sFound" oninput="search('found')" placeholder="Search found item">
<div id="sgFound" class="suggest"></div>
</div>

<!-- ADD LOST -->
<div class="section">
<h2>ğŸ”´ Add Lost Item</h2>
<input id="ln" placeholder="Your Name">
<input id="lc" placeholder="Contact">
<input id="li" placeholder="Lost Item">
<input id="ll" placeholder="Location">
<button onclick="addLost()">Submit Lost</button>
</div>

<!-- ADD FOUND -->
<div class="section">
<h2>ğŸŸ¢ Add Found Item</h2>
<input id="fn" placeholder="Your Name">
<input id="fc" placeholder="Contact">
<input id="fi" placeholder="Found Item">
<input id="fl" placeholder="Location">
<button onclick="addFound()">Submit Found</button>
</div>

<!-- LIST -->
<div class="section">
<h2>ğŸ“‹ Items</h2>
<div id="list"></div>
</div>

<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

<script>
firebase.initializeApp({
 apiKey:"AIzaSyDKy_RM1zrJS2Ux-mrf-ZSAFG3QJGSvm_c",
 authDomain:"back2you-lite-e6695.firebaseapp.com",
 projectId:"back2you-lite-e6695"
});

const db=firebase.firestore();
let items=[];

function fuzzy(q,t){
 q=q.toLowerCase(); t=t.toLowerCase();
 let i=0;
 for(let c of t) if(c===q[i]) i++;
 return i===q.length;
}

function addLost(){
 if(!ln.value||!lc.value||!li.value||!ll.value) return alert("Fill all");
 db.collection("items").add({
  type:"lost",name:ln.value,contact:lc.value,
  item:li.value,location:ll.value,
  time:new Date().toLocaleString()
 });
 ln.value=lc.value=li.value=ll.value="";
}

function addFound(){
 if(!fn.value||!fc.value||!fi.value||!fl.value) return alert("Fill all");
 db.collection("items").add({
  type:"found",name:fn.value,contact:fc.value,
  item:fi.value,location:fl.value,
  time:new Date().toLocaleString()
 });
 fn.value=fc.value=fi.value=fl.value="";
}

function search(type){
 let q=(type==="lost"?sLost.value:sFound.value).toLowerCase();
 let sg=type==="lost"?sgLost:sgFound;
 sg.innerHTML="";
 items.filter(i=>i.type===type && fuzzy(q,i.item))
 .slice(0,5).forEach(i=>{
  let d=document.createElement("div");
  d.innerText=i.item;
  d.onclick=()=>document.getElementById(i.id).scrollIntoView({behavior:"smooth"});
  sg.appendChild(d);
 });
 render(q,type);
}

function render(q="",type=""){
 list.innerHTML="";
 items.forEach(i=>{
  if(type && i.type!==type) return;
  list.innerHTML+=`
  <div class="card ${i.type}" id="${i.id}">
   <b>${i.type.toUpperCase()}</b><br>
   ğŸ‘¤ ${i.name}<br>
   ğŸ“ ${i.contact}<br>
   ğŸ“¦ ${i.item}<br>
   ğŸ“ ${i.location}<br>
   ğŸ•’ ${i.time}<br>
   <button class="edit" onclick="edit('${i.id}','${i.item}')">Edit</button>
   <button class="del" onclick="del('${i.id}')">Delete</button>
  </div>`;
 });
}

function edit(id,o){
 let n=prompt("Edit item",o);
 if(n) db.collection("items").doc(id).update({item:n});
}

function del(id){
 if(confirm("Delete?")) db.collection("items").doc(id).delete();
}

db.collection("items").onSnapshot(s=>{
 items=[];
 s.forEach(d=>items.push({id:d.id,...d.data()}));
 render();
});
</script>

</body>
</html>
