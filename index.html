<!DOCTYPE html>
<html lang="en">
<head>
  <title>Back2You - College Lost & Found Platform</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="College campus lost and found platform for students and staff.">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
  <style>
    /* Modern CSS Variables */
    :root {
      --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --secondary-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      --success-gradient: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
      --warning-gradient: linear-gradient(135deg, #f6d365 0%, #fda085 100%);
      --danger-gradient: linear-gradient(135deg, #ff0844 0%, #ffb199 100%);
      --primary-color: #5a67d8;
      --primary-dark: #4c51bf;
      --secondary-color: #38b2ac;
      --success-color: #48bb78;
      --warning-color: #ed8936;
      --danger-color: #f56565;
      --light-bg: #f7fafc;
      --card-bg: #ffffff;
      --dark-bg: #1a202c;
      --dark-card: #2d3748;
      --text-color: #2d3748;
      --text-light: #718096;
      --border-color: #e2e8f0;
      --border-radius: 12px;
      --border-radius-lg: 16px;
      --border-radius-sm: 8px;
      --shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      --shadow-lg: 0 20px 40px -10px rgba(0, 0, 0, 0.15);
      --shadow-inner: inset 0 2px 4px 0 rgba(0, 0, 0, 0.06);
      --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      --transition-slow: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* Dark Theme */
    .dark-mode {
      --light-bg: #1a202c;
      --card-bg: #2d3748;
      --dark-card: #4a5568;
      --text-color: #f7fafc;
      --text-light: #cbd5e0;
      --border-color: #4a5568;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: var(--light-bg);
      color: var(--text-color);
      line-height: 1.6;
      transition: var(--transition-slow);
      min-height: 100vh;
      padding: 0;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    /* Header & Navigation */
    header {
      background: var(--primary-gradient);
      color: white;
      padding: 1.5rem 0;
      box-shadow: var(--shadow);
      position: sticky;
      top: 0;
      z-index: 1000;
    }

    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo i {
      font-size: 2rem;
      background: rgba(255, 255, 255, 0.2);
      padding: 10px;
      border-radius: 50%;
    }

    .logo h1 {
      font-size: 1.8rem;
      font-weight: 700;
      margin: 0;
    }

    .logo p {
      font-size: 0.9rem;
      opacity: 0.9;
      margin: 0;
    }

    .header-controls {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    /* Dark Mode Toggle Button - NEW STYLE */
    .dark-mode-toggle {
      position: absolute;
      top: 20px;
      right: 20px;
      z-index: 1001;
    }

    .dark-mode-btn {
      background: rgba(255, 255, 255, 0.2);
      border: 2px solid rgba(255, 255, 255, 0.3);
      color: white;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: var(--transition);
      font-size: 1.2rem;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .dark-mode-btn:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: rotate(30deg);
    }

    /* Stats Bar */
    .stats-bar {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin: 30px 0;
    }

    .stat-card {
      background: var(--card-bg);
      border-radius: var(--border-radius);
      padding: 20px;
      display: flex;
      align-items: center;
      gap: 15px;
      box-shadow: var(--shadow);
      transition: var(--transition);
      cursor: pointer;
    }

    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-lg);
    }

    .stat-icon {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      color: white;
    }

    .stat-icon.lost {
      background: var(--warning-gradient);
    }

    .stat-icon.found {
      background: var(--success-gradient);
    }

    .stat-icon.matched {
      background: var(--secondary-gradient);
    }

    .stat-info h3 {
      font-size: 1.8rem;
      margin: 0;
    }

    .stat-info p {
      color: var(--text-light);
      margin: 0;
      font-size: 0.9rem;
    }

    /* Navigation */
    .nav-tabs {
      background: var(--card-bg);
      border-radius: var(--border-radius);
      padding: 10px;
      margin: 20px 0;
      display: flex;
      gap: 10px;
      box-shadow: var(--shadow);
    }

    .nav-tab {
      flex: 1;
      padding: 12px 20px;
      border: none;
      background: transparent;
      color: var(--text-light);
      border-radius: var(--border-radius-sm);
      cursor: pointer;
      font-weight: 500;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .nav-tab:hover {
      background: var(--light-bg);
      color: var(--text-color);
    }

    .nav-tab.active {
      background: var(--primary-gradient);
      color: white;
      box-shadow: var(--shadow);
    }

    /* Report Forms */
    .report-forms {
      margin: 30px 0;
    }

    .form-section {
      display: none;
      animation: fadeIn 0.5s ease;
    }

    .form-section.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .form-card {
      background: var(--card-bg);
      border-radius: var(--border-radius-lg);
      padding: 40px;
      box-shadow: var(--shadow-lg);
      transition: var(--transition);
      border: 1px solid var(--border-color);
    }

    .form-card.lost-form {
      border-top: 4px solid var(--warning-color);
    }

    .form-card.found-form {
      border-top: 4px solid var(--success-color);
    }

    .form-header {
      text-align: center;
      margin-bottom: 40px;
    }

    .form-header h2 {
      font-size: 2rem;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
    }

    .form-header p {
      color: var(--text-light);
      max-width: 600px;
      margin: 0 auto;
    }

    /* Form Elements */
    .form-grid {
      display: grid;
      gap: 25px;
    }

    @media (min-width: 768px) {
      .form-grid {
        grid-template-columns: 1fr 1fr;
      }
    }

    .form-group {
      margin-bottom: 25px;
    }

    .form-group.full-width {
      grid-column: 1 / -1;
    }

    .form-label {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 10px;
      font-weight: 600;
      color: var(--text-color);
    }

    .form-label .required {
      color: var(--danger-color);
      margin-left: 4px;
    }

    .form-control {
      width: 100%;
      padding: 16px 20px;
      border: 2px solid var(--border-color);
      border-radius: var(--border-radius-sm);
      font-size: 16px;
      transition: var(--transition);
      background: var(--card-bg);
      color: var(--text-color);
    }

    .form-control:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(90, 103, 216, 0.1);
    }

    .form-control::placeholder {
      color: var(--text-light);
    }

    textarea.form-control {
      min-height: 120px;
      resize: vertical;
    }

    select.form-control {
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%23718096' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 20px center;
      background-size: 16px;
      padding-right: 50px;
    }

    /* Form Steps */
    .form-steps {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 40px;
      position: relative;
    }

    .form-steps::before {
      content: '';
      position: absolute;
      top: 20px;
      left: 0;
      right: 0;
      height: 2px;
      background: var(--border-color);
      z-index: 1;
    }

    .form-step {
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      z-index: 2;
      cursor: pointer;
    }

    .step-number {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: var(--light-bg);
      border: 2px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      margin-bottom: 10px;
      transition: var(--transition);
    }

    .form-step.active .step-number {
      background: var(--primary-gradient);
      border-color: var(--primary-color);
      color: white;
    }

    .form-step.completed .step-number {
      background: var(--success-color);
      border-color: var(--success-color);
      color: white;
    }

    .step-label {
      font-size: 0.9rem;
      color: var(--text-light);
      text-align: center;
    }

    .form-step.active .step-label {
      color: var(--primary-color);
      font-weight: 600;
    }

    /* Form Pages */
    .form-page {
      display: none;
      animation: slideIn 0.3s ease;
    }

    .form-page.active {
      display: block;
    }

    @keyframes slideIn {
      from { opacity: 0; transform: translateX(20px); }
      to { opacity: 1; transform: translateX(0); }
    }

    /* Buttons */
    .btn {
      padding: 16px 32px;
      border: none;
      border-radius: var(--border-radius-sm);
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .btn-primary {
      background: var(--primary-gradient);
      color: white;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(90, 103, 216, 0.2);
    }

    .btn-success {
      background: var(--success-gradient);
      color: white;
    }

    .btn-warning {
      background: var(--warning-gradient);
      color: white;
    }

    .btn-outline {
      background: transparent;
      border: 2px solid var(--primary-color);
      color: var(--primary-color);
    }

    .btn-outline:hover {
      background: var(--primary-color);
      color: white;
    }

    .btn-icon {
      width: 44px;
      height: 44px;
      padding: 0;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .form-actions {
      display: flex;
      justify-content: space-between;
      margin-top: 40px;
      padding-top: 30px;
      border-top: 1px solid var(--border-color);
    }

    /* File Upload */
    .file-upload {
      border: 2px dashed var(--border-color);
      border-radius: var(--border-radius);
      padding: 40px 20px;
      text-align: center;
      cursor: pointer;
      transition: var(--transition);
      background: var(--light-bg);
    }

    .file-upload:hover {
      border-color: var(--primary-color);
      background: rgba(90, 103, 216, 0.05);
    }

    .file-upload i {
      font-size: 3rem;
      color: var(--text-light);
      margin-bottom: 15px;
    }

    .file-upload input[type="file"] {
      display: none;
    }

    .file-upload label {
      color: var(--primary-color);
      font-weight: 600;
      cursor: pointer;
      display: inline-block;
      margin: 10px 0;
    }

    .file-preview {
      margin-top: 20px;
      display: none;
    }

    .file-preview img {
      max-width: 200px;
      max-height: 200px;
      border-radius: var(--border-radius-sm);
      object-fit: cover;
      border: 2px solid var(--border-color);
    }

    /* Image Grid */
    .image-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 15px;
      margin-top: 20px;
    }

    .image-preview {
      position: relative;
      border-radius: var(--border-radius-sm);
      overflow: hidden;
      aspect-ratio: 1;
    }

    .image-preview img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: var(--transition);
    }

    .image-preview:hover img {
      transform: scale(1.1);
    }

    .remove-image {
      position: absolute;
      top: 5px;
      right: 5px;
      background: rgba(245, 101, 101, 0.9);
      color: white;
      border: none;
      border-radius: 50%;
      width: 28px;
      height: 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      opacity: 0;
      transition: var(--transition);
    }

    .image-preview:hover .remove-image {
      opacity: 1;
    }

    /* Found Item Details */
    .found-details-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 25px;
      margin-bottom: 30px;
    }

    .detail-card {
      background: var(--light-bg);
      border-radius: var(--border-radius);
      padding: 20px;
      border: 1px solid var(--border-color);
    }

    .detail-card h4 {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 15px;
      color: var(--primary-color);
    }

    /* Toggle Sections - FIXED */
    .toggle-section {
      margin: 30px 0;
    }

    .toggle-header {
      background: var(--card-bg);
      border-radius: var(--border-radius);
      padding: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
      box-shadow: var(--shadow);
      transition: var(--transition);
      border: 1px solid var(--border-color);
    }

    .toggle-header:hover {
      background: var(--light-bg);
    }

    .toggle-header.active {
      border-bottom-left-radius: 0;
      border-bottom-right-radius: 0;
    }

    .toggle-content {
      background: var(--card-bg);
      border-radius: 0 0 var(--border-radius) var(--border-radius);
      padding: 30px;
      box-shadow: var(--shadow);
      display: none;
      border: 1px solid var(--border-color);
      border-top: none;
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease, padding 0.3s ease;
    }

    .toggle-content.active {
      display: block;
      max-height: 2000px;
      animation: slideDown 0.3s ease;
    }

    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .toggle-icon {
      transition: var(--transition);
    }

    /* Items List */
    .items-list {
      display: grid;
      gap: 20px;
      margin-top: 20px;
    }

    .item-card {
      background: var(--card-bg);
      border-radius: var(--border-radius);
      padding: 20px;
      box-shadow: var(--shadow);
      border-left: 4px solid;
      transition: var(--transition);
      position: relative;
      overflow: hidden;
    }

    .item-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-lg);
    }

    .item-card.lost {
      border-left-color: var(--warning-color);
    }

    .item-card.found {
      border-left-color: var(--success-color);
    }

    .item-card.matched {
      border-left-color: var(--primary-color);
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.9; }
    }

    .item-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 15px;
    }

    .item-title {
      font-weight: 600;
      font-size: 1.2rem;
      margin: 0;
    }

    .item-badge {
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 600;
      text-transform: uppercase;
    }

    .badge-lost {
      background: rgba(237, 137, 54, 0.1);
      color: var(--warning-color);
    }

    .badge-found {
      background: rgba(56, 178, 172, 0.1);
      color: var(--success-color);
    }

    .badge-matched {
      background: rgba(90, 103, 216, 0.1);
      color: var(--primary-color);
    }

    .item-meta {
      display: flex;
      gap: 15px;
      margin: 10px 0;
      color: var(--text-light);
      font-size: 0.9rem;
    }

    .item-meta i {
      margin-right: 5px;
    }

    .item-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .item-image {
      width: 100%;
      height: 200px;
      object-fit: cover;
      border-radius: var(--border-radius-sm);
      margin: 15px 0;
      background: var(--light-bg);
      border: 1px solid var(--border-color);
    }

    /* Search & Filter */
    .search-container {
      position: relative;
      margin-bottom: 20px;
    }

    .search-input {
      width: 100%;
      padding: 16px 50px 16px 50px;
      border: 2px solid var(--border-color);
      border-radius: var(--border-radius);
      font-size: 16px;
      transition: var(--transition);
      background: var(--card-bg);
      color: var(--text-color);
    }

    .search-icon {
      position: absolute;
      left: 20px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--text-light);
    }

    .filter-buttons {
      display: flex;
      gap: 10px;
      margin: 20px 0;
      flex-wrap: wrap;
    }

    .filter-btn {
      padding: 8px 16px;
      border: 2px solid var(--border-color);
      background: transparent;
      border-radius: var(--border-radius-sm);
      color: var(--text-color);
      cursor: pointer;
      transition: var(--transition);
    }

    .filter-btn.active {
      background: var(--primary-color);
      color: white;
      border-color: var(--primary-color);
    }

    /* Modal */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 2000;
      align-items: center;
      justify-content: center;
      padding: 20px;
      animation: fadeIn 0.3s ease;
    }

    .modal-content {
      background: var(--card-bg);
      border-radius: var(--border-radius-lg);
      padding: 40px;
      max-width: 500px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: var(--shadow-lg);
      animation: slideUp 0.3s ease;
    }

    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(50px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
    }

    .modal-title {
      font-size: 1.5rem;
      margin: 0;
    }

    .modal-close {
      background: transparent;
      border: none;
      font-size: 1.5rem;
      color: var(--text-light);
      cursor: pointer;
      transition: var(--transition);
    }

    .modal-close:hover {
      color: var(--text-color);
    }

    /* Toast Notifications */
    .toast-container {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 3000;
    }

    .toast {
      background: var(--card-bg);
      border-radius: var(--border-radius);
      padding: 20px;
      margin-bottom: 10px;
      box-shadow: var(--shadow-lg);
      display: flex;
      align-items: center;
      gap: 15px;
      min-width: 300px;
      animation: slideInRight 0.3s ease;
      border-left: 4px solid;
    }

    @keyframes slideInRight {
      from {
        opacity: 0;
        transform: translateX(100%);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .toast.success {
      border-left-color: var(--success-color);
    }

    .toast.error {
      border-left-color: var(--danger-color);
    }

    .toast.info {
      border-left-color: var(--primary-color);
    }

    .toast-icon {
      font-size: 1.5rem;
    }

    .toast.success .toast-icon {
      color: var(--success-color);
    }

    .toast.error .toast-icon {
      color: var(--danger-color);
    }

    .toast.info .toast-icon {
      color: var(--primary-color);
    }

    .toast-message {
      flex: 1;
    }

    .toast-title {
      font-weight: 600;
      margin-bottom: 5px;
    }

    .toast-close {
      background: transparent;
      border: none;
      color: var(--text-light);
      cursor: pointer;
      font-size: 1.2rem;
    }

    /* Loading Spinner */
    .spinner-container {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 40px;
    }

    .spinner {
      width: 50px;
      height: 50px;
      border: 3px solid var(--border-color);
      border-top-color: var(--primary-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 40px;
      color: var(--text-light);
    }

    .empty-state i {
      font-size: 3rem;
      margin-bottom: 20px;
      opacity: 0.5;
    }

    /* Footer */
    footer {
      background: var(--card-bg);
      padding: 40px 0;
      margin-top: 60px;
      border-top: 1px solid var(--border-color);
    }

    .footer-content {
      text-align: center;
    }

    .footer-links {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 20px 0;
      flex-wrap: wrap;
    }

    .footer-link {
      color: var(--text-light);
      text-decoration: none;
      transition: var(--transition);
    }

    .footer-link:hover {
      color: var(--primary-color);
    }

    .copyright {
      color: var(--text-light);
      font-size: 0.9rem;
      margin-top: 10px;
    }

    .team-name {
      color: var(--primary-color);
      font-weight: 600;
      font-size: 1.1rem;
      margin-top: 5px;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .header-content {
        flex-direction: column;
        gap: 15px;
        text-align: center;
      }

      .nav-tabs {
        flex-direction: column;
      }

      .form-card {
        padding: 20px;
      }

      .form-steps {
        flex-wrap: wrap;
        gap: 20px;
      }

      .form-steps::before {
        display: none;
      }

      .modal-content {
        padding: 20px;
      }

      .stats-bar {
        grid-template-columns: 1fr;
      }

      .dark-mode-toggle {
        top: 10px;
        right: 10px;
      }

      .dark-mode-btn {
        width: 40px;
        height: 40px;
        font-size: 1rem;
      }

      .footer-links {
        flex-direction: column;
        gap: 10px;
      }
    }

    @media (max-width: 480px) {
      .footer-links {
        flex-direction: column;
        gap: 10px;
      }
    }
  </style>
</head>
<body>
  <!-- Dark Mode Toggle Button -->
  <div class="dark-mode-toggle">
    <button class="dark-mode-btn" onclick="toggleDarkMode()" aria-label="Toggle Dark Mode" title="Toggle Dark Mode">
      <i class="fas fa-moon"></i>
    </button>
  </div>

  <!-- Header -->
  <header>
    <div class="container header-content">
      <div class="logo">
        <i class="fas fa-search-location"></i>
        <div>
          <h1>Back2You</h1>
          <p>College Lost & Found Platform</p>
        </div>
      </div>
      <div class="header-controls">
        <button class="btn btn-primary" onclick="showQuickGuide()">
          <i class="fas fa-question-circle"></i> Quick Guide
        </button>
      </div>
    </div>
  </header>

  <!-- Stats Bar -->
  <div class="container stats-bar">
    <div class="stat-card" onclick="scrollToSection('lostContainer')">
      <div class="stat-icon lost">
        <i class="fas fa-exclamation-triangle"></i>
      </div>
      <div class="stat-info">
        <h3 id="lostCount">0</h3>
        <p>Lost Items</p>
      </div>
    </div>
    <div class="stat-card" onclick="scrollToSection('foundContainer')">
      <div class="stat-icon found">
        <i class="fas fa-check-circle"></i>
      </div>
      <div class="stat-info">
        <h3 id="foundCount">0</h3>
        <p>Found Items</p>
      </div>
    </div>
    <div class="stat-card" onclick="showMatchedItems()">
      <div class="stat-icon matched">
        <i class="fas fa-handshake"></i>
      </div>
      <div class="stat-info">
        <h3 id="matchedCount">0</h3>
        <p>Successful Matches</p>
      </div>
    </div>
  </div>

  <!-- Report Forms Navigation -->
  <div class="container">
    <div class="nav-tabs">
      <button class="nav-tab active" onclick="showReportForm('lost')">
        <i class="fas fa-exclamation-triangle"></i>
        Report Lost Item
      </button>
      <button class="nav-tab" onclick="showReportForm('found')">
        <i class="fas fa-check-circle"></i>
        Report Found Item
      </button>
    </div>
  </div>

  <!-- Report Forms -->
  <div class="container report-forms">
    <!-- Lost Item Form -->
    <div id="lostFormSection" class="form-section active">
      <div class="form-card lost-form">
        <div class="form-header">
          <h2><i class="fas fa-exclamation-triangle"></i> Report a Lost Item</h2>
          <p>Help us reunite you with your lost belongings by providing detailed information below.</p>
        </div>
        
        <form id="lostForm" onsubmit="handleLostFormSubmit(event)">
          <div class="form-grid">
            <div class="form-group">
              <label class="form-label" for="lName">
                <i class="fas fa-user"></i> Your Full Name
                <span class="required">*</span>
              </label>
              <input class="form-control" id="lName" type="text" required 
                     placeholder="Enter your full name">
            </div>
            
            <div class="form-group">
              <label class="form-label" for="lContact">
                <i class="fas fa-phone"></i> Contact Information
                <span class="required">*</span>
              </label>
              <input class="form-control" id="lContact" type="text" required 
                     placeholder="Phone number or email address">
            </div>
            
            <div class="form-group">
              <label class="form-label" for="lItem">
                <i class="fas fa-box"></i> Item Name
                <span class="required">*</span>
              </label>
              <input class="form-control" id="lItem" type="text" required 
                     placeholder="e.g., Laptop, ID Card, Keys, Calculator">
            </div>
            
            <div class="form-group">
              <label class="form-label" for="lCategory">
                <i class="fas fa-tag"></i> Category
                <span class="required">*</span>
              </label>
              <select class="form-control" id="lCategory" required>
                <option value="">Select a category</option>
                <option value="electronics">üì± Electronics</option>
                <option value="documents">üìÑ Documents/ID Cards</option>
                <option value="stationery">‚úèÔ∏è Stationery</option>
                <option value="clothing">üëï Clothing</option>
                <option value="keys">üîë Keys</option>
                <option value="bag">üéí Bag/Backpack</option>
                <option value="books">üìö Books/Notebooks</option>
                <option value="other">üì¶ Other</option>
              </select>
            </div>
            
            <div class="form-group">
              <label class="form-label" for="lDate">
                <i class="fas fa-calendar"></i> Date Lost
                <span class="required">*</span>
              </label>
              <input class="form-control" id="lDate" type="date" required>
            </div>
            
            <div class="form-group">
              <label class="form-label" for="lTime">
                <i class="fas fa-clock"></i> Approximate Time
              </label>
              <input class="form-control" id="lTime" type="time">
            </div>
            
            <div class="form-group full-width">
              <label class="form-label" for="lLoc">
                <i class="fas fa-map-marker-alt"></i> Location Where Lost
              </label>
              <input class="form-control" id="lLoc" type="text" 
                     placeholder="e.g., Physics Lab, Library, Cafeteria, Classroom A">
            </div>
            
            <div class="form-group full-width">
              <label class="form-label" for="lDesc">
                <i class="fas fa-align-left"></i> Detailed Description
                <span class="required">*</span>
              </label>
              <textarea class="form-control" id="lDesc" rows="4" required
                        placeholder="Provide detailed description including:
‚Ä¢ Color, size, and brand
‚Ä¢ Distinctive features or marks
‚Ä¢ Contents (if bag/wallet)
‚Ä¢ Serial number (if electronics)"></textarea>
            </div>
            
            <div class="form-group full-width">
              <label class="form-label">
                <i class="fas fa-images"></i> Upload Reference Photos (Optional)
              </label>
              <div class="file-upload" onclick="document.getElementById('lImage').click()">
                <i class="fas fa-cloud-upload-alt"></i>
                <p>Click to upload reference photos</p>
                <label>Choose Files</label>
                <p class="small-text">Max file size: 5MB. Supported: JPG, PNG, GIF</p>
                <input id="lImage" type="file" accept="image/*" multiple 
                       onchange="handleLostImageUpload(event)">
              </div>
              <div id="lostImagePreview" class="image-grid"></div>
            </div>
          </div>
          
          <div class="form-actions">
            <button type="reset" class="btn btn-outline">
              <i class="fas fa-redo"></i> Clear Form
            </button>
            <button type="submit" class="btn btn-warning">
              <i class="fas fa-paper-plane"></i> Report Lost Item
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Found Item Form -->
    <div id="foundFormSection" class="form-section">
      <div class="form-card found-form">
        <div class="form-header">
          <h2><i class="fas fa-check-circle"></i> Report a Found Item</h2>
          <p>Help reunite lost items with their owners by providing detailed information below.</p>
        </div>
        
        <!-- Form Steps -->
        <div class="form-steps">
          <div class="form-step active" onclick="goToStep(1)">
            <div class="step-number">1</div>
            <div class="step-label">Basic Info</div>
          </div>
          <div class="form-step" onclick="goToStep(2)">
            <div class="step-number">2</div>
            <div class="step-label">Item Details</div>
          </div>
          <div class="form-step" onclick="goToStep(3)">
            <div class="step-number">3</div>
            <div class="step-label">Photos & Contact</div>
          </div>
        </div>
        
        <!-- Multi-step Form -->
        <form id="foundForm" onsubmit="handleFoundFormSubmit(event)">
          <!-- Step 1: Basic Information -->
          <div id="foundStep1" class="form-page active">
            <div class="found-details-grid">
              <div class="detail-card">
                <h4><i class="fas fa-user-circle"></i> About You</h4>
                <div class="form-group">
                  <label class="form-label" for="fName">
                    Your Name
                    <span class="required">*</span>
                  </label>
                  <input class="form-control" id="fName" type="text" required 
                         placeholder="Enter your full name">
                </div>
                <div class="form-group">
                  <label class="form-label" for="fContact">
                    Contact Information
                    <span class="required">*</span>
                  </label>
                  <input class="form-control" id="fContact" type="text" required 
                         placeholder="Phone number or email address">
                </div>
                <div class="form-group">
                  <label class="form-label" for="fOrganization">
                    Department/Role (Optional)
                  </label>
                  <input class="form-control" id="fOrganization" type="text" 
                         placeholder="e.g., Computer Science, Faculty, Student">
                </div>
              </div>
              
              <div class="detail-card">
                <h4><i class="fas fa-map-marker-alt"></i> Location Details</h4>
                <div class="form-group">
                  <label class="form-label" for="fDate">
                    Date Found
                    <span class="required">*</span>
                  </label>
                  <input class="form-control" id="fDate" type="date" required>
                </div>
                <div class="form-group">
                  <label class="form-label" for="fTime">
                    Time Found
                  </label>
                  <input class="form-control" id="fTime" type="time">
                </div>
                <div class="form-group">
                  <label class="form-label" for="fLoc">
                    Location Found
                    <span class="required">*</span>
                  </label>
                  <input class="form-control" id="fLoc" type="text" required
                         placeholder="e.g., Computer Lab, Library, Main Building, Cafeteria">
                </div>
              </div>
            </div>
            
            <div class="form-actions">
              <button type="button" class="btn btn-outline" onclick="goToStep(2)">
                Next <i class="fas fa-arrow-right"></i>
              </button>
            </div>
          </div>
          
          <!-- Step 2: Item Details -->
          <div id="foundStep2" class="form-page">
            <div class="found-details-grid">
              <div class="detail-card">
                <h4><i class="fas fa-box-open"></i> Item Information</h4>
                <div class="form-group">
                  <label class="form-label" for="fItem">
                    What did you find?
                    <span class="required">*</span>
                  </label>
                  <input class="form-control" id="fItem" type="text" required 
                         placeholder="Describe the item">
                </div>
                <div class="form-group">
                  <label class="form-label" for="fCategory">
                    Category
                    <span class="required">*</span>
                  </label>
                  <select class="form-control" id="fCategory" required>
                    <option value="">Select a category</option>
                    <option value="electronics">üì± Electronics</option>
                    <option value="documents">üìÑ Documents/ID Cards</option>
                    <option value="stationery">‚úèÔ∏è Stationery</option>
                    <option value="clothing">üëï Clothing</option>
                    <option value="keys">üîë Keys</option>
                    <option value="bag">üéí Bag/Backpack</option>
                    <option value="books">üìö Books/Notebooks</option>
                    <option value="other">üì¶ Other</option>
                  </select>
                </div>
                <div class="form-group">
                  <label class="form-label" for="fCondition">
                    Item Condition
                  </label>
                  <select class="form-control" id="fCondition">
                    <option value="">Select condition</option>
                    <option value="new">New/Like New</option>
                    <option value="good">Good</option>
                    <option value="fair">Fair/Used</option>
                    <option value="damaged">Damaged</option>
                  </select>
                </div>
              </div>
              
              <div class="detail-card">
                <h4><i class="fas fa-clipboard-list"></i> Additional Details</h4>
                <div class="form-group">
                  <label class="form-label" for="fColor">
                    Color
                  </label>
                  <input class="form-control" id="fColor" type="text" 
                         placeholder="e.g., Black, Blue, Red">
                </div>
                <div class="form-group">
                  <label class="form-label" for="fBrand">
                    Brand/Manufacturer
                  </label>
                  <input class="form-control" id="fBrand" type="text" 
                         placeholder="e.g., Dell, HP, Samsung">
                </div>
                <div class="form-group">
                  <label class="form-label" for="fModel">
                    Model/ID Number
                  </label>
                  <input class="form-control" id="fModel" type="text" 
                         placeholder="If visible/applicable">
                </div>
              </div>
            </div>
            
            <div class="form-group full-width">
              <label class="form-label" for="fDesc">
                <i class="fas fa-align-left"></i> Detailed Description
                <span class="required">*</span>
              </label>
              <textarea class="form-control" id="fDesc" rows="4" required
                        placeholder="Provide detailed description including:
‚Ä¢ Distinctive features or marks
‚Ä¢ Contents found inside (if any)
‚Ä¢ Any identifiers (student ID, name)
‚Ä¢ State of the item"></textarea>
            </div>
            
            <div class="form-actions">
              <button type="button" class="btn btn-outline" onclick="goToStep(1)">
                <i class="fas fa-arrow-left"></i> Back
              </button>
              <button type="button" class="btn btn-outline" onclick="goToStep(3)">
                Next <i class="fas fa-arrow-right"></i>
              </button>
            </div>
          </div>
          
          <!-- Step 3: Photos & Contact -->
          <div id="foundStep3" class="form-page">
            <div class="found-details-grid">
              <div class="detail-card">
                <h4><i class="fas fa-camera"></i> Item Photos</h4>
                <p class="small-text">Clear photos help owners identify their items faster.</p>
                
                <div class="file-upload" onclick="document.getElementById('fImage').click()">
                  <i class="fas fa-camera"></i>
                  <p>Click to upload clear photos</p>
                  <label>Choose Files</label>
                  <p class="small-text">Max 5 photos, 5MB each. JPG, PNG</p>
                  <input id="fImage" type="file" accept="image/*" multiple 
                         onchange="handleFoundImageUpload(event)">
                </div>
                
                <div id="foundImagePreview" class="image-grid"></div>
              </div>
              
              <div class="detail-card">
                <h4><i class="fas fa-hand-holding-heart"></i> Safe Keeping</h4>
                <div class="form-group">
                  <label class="form-label" for="fStorage">
                    Current Storage Location
                  </label>
                  <select class="form-control" id="fStorage">
                    <option value="">Where is it kept?</option>
                    <option value="myself">With me (I'll keep it safe)</option>
                    <option value="office">College Office</option>
                    <option value="staffroom">Staff Room</option>
                  </select>
                </div>
                <div class="form-group">
                  <label class="form-label" for="fAvailability">
                    When are you available?
                  </label>
                  <input class="form-control" id="fAvailability" type="text" 
                         placeholder="e.g., Weekdays 9-5, Anytime">
                </div>
                <div class="form-group">
                  <label class="form-label">
                    <input type="checkbox" id="fAnonymous">
                    Report anonymously
                  </label>
                  <small class="form-text">Your contact will be shared only with the owner</small>
                </div>
              </div>
            </div>
            
            <div class="form-group full-width">
              <label class="form-label" for="fNotes">
                <i class="fas fa-sticky-note"></i> Additional Notes (Optional)
              </label>
              <textarea class="form-control" id="fNotes" rows="3"
                        placeholder="Any additional information that might help the owner identify the item..."></textarea>
            </div>
            
            <div class="form-actions">
              <button type="button" class="btn btn-outline" onclick="goToStep(2)">
                <i class="fas fa-arrow-left"></i> Back
              </button>
              <button type="submit" class="btn btn-success">
                <i class="fas fa-paper-plane"></i> Submit Found Report
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Browse Items Section -->
  <div class="container toggle-section">
    <div class="toggle-header" onclick="toggleSection('lostContainer')">
      <div>
        <h3><i class="fas fa-exclamation-triangle"></i> Browse Lost Items</h3>
        <p>Search for items reported as lost by students & staff</p>
      </div>
      <i class="fas fa-chevron-down toggle-icon"></i>
    </div>
    <div id="lostContainer" class="toggle-content">
      <div class="search-container">
        <i class="fas fa-search search-icon"></i>
        <input class="search-input" id="searchLost" type="text" 
               placeholder="Search lost items by name, category, location..." 
               oninput="debounceFilter('lost')">
      </div>
      <div class="filter-buttons">
        <button class="filter-btn active" onclick="filterItems('lost', 'all')">All</button>
        <button class="filter-btn" onclick="filterItems('lost', 'electronics')">Electronics</button>
        <button class="filter-btn" onclick="filterItems('lost', 'documents')">Documents</button>
        <button class="filter-btn" onclick="filterItems('lost', 'stationery')">Stationery</button>
        <button class="filter-btn" onclick="filterItems('lost', 'keys')">Keys</button>
        <button class="filter-btn" onclick="filterItems('lost', 'books')">Books</button>
        <button class="filter-btn" onclick="filterItems('lost', 'other')">Other</button>
      </div>
      <div id="lostList" class="items-list">
        <div class="spinner-container">
          <div class="spinner"></div>
        </div>
      </div>
    </div>
  </div>

  <div class="container toggle-section">
    <div class="toggle-header" onclick="toggleSection('foundContainer')">
      <div>
        <h3><i class="fas fa-check-circle"></i> Browse Found Items</h3>
        <p>Search for items reported as found in campus</p>
      </div>
      <i class="fas fa-chevron-down toggle-icon"></i>
    </div>
    <div id="foundContainer" class="toggle-content">
      <div class="search-container">
        <i class="fas fa-search search-icon"></i>
        <input class="search-input" id="searchFound" type="text" 
               placeholder="Search found items by name, category, location..." 
               oninput="debounceFilter('found')">
      </div>
      <div class="filter-buttons">
        <button class="filter-btn active" onclick="filterItems('found', 'all')">All</button>
        <button class="filter-btn" onclick="filterItems('found', 'electronics')">Electronics</button>
        <button class="filter-btn" onclick="filterItems('found', 'documents')">Documents</button>
        <button class="filter-btn" onclick="filterItems('found', 'stationery')">Stationery</button>
        <button class="filter-btn" onclick="filterItems('found', 'keys')">Keys</button>
        <button class="filter-btn" onclick="filterItems('found', 'books')">Books</button>
        <button class="filter-btn" onclick="filterItems('found', 'other')">Other</button>
      </div>
      <div id="foundList" class="items-list">
        <div class="spinner-container">
          <div class="spinner"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modals -->
  <div id="editModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title"><i class="fas fa-edit"></i> Edit Item</h3>
        <button class="modal-close" onclick="closeModal()">&times;</button>
      </div>
      <form id="editForm" onsubmit="handleEditSubmit(event)">
        <div class="form-group">
          <label class="form-label">Item Name</label>
          <input class="form-control" id="editItem" type="text" required>
        </div>
        <div class="form-grid">
          <div class="form-group">
            <label class="form-label">Category</label>
            <select class="form-control" id="editCategory" required>
              <option value="electronics">Electronics</option>
              <option value="documents">Documents/ID Cards</option>
              <option value="stationery">Stationery</option>
              <option value="clothing">Clothing</option>
              <option value="keys">Keys</option>
              <option value="bag">Bag/Backpack</option>
              <option value="books">Books/Notebooks</option>
              <option value="other">Other</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">Date</label>
            <input class="form-control" id="editDate" type="date" required>
          </div>
        </div>
        <div class="form-group">
          <label class="form-label">Location</label>
          <input class="form-control" id="editLocation" type="text" required 
                 placeholder="e.g., Physics Lab, Library, Cafeteria">
        </div>
        <div class="form-group">
          <label class="form-label">Description</label>
          <textarea class="form-control" id="editDesc" rows="3"></textarea>
        </div>
        <div class="form-group">
          <label class="form-label">Contact Info</label>
          <input class="form-control" id="editContact" type="text" required>
        </div>
        <div style="display: flex; gap: 10px; margin-top: 20px;">
          <button type="submit" class="btn btn-primary" style="flex: 1;">
            <i class="fas fa-save"></i> Save Changes
          </button>
          <button type="button" class="btn btn-outline" onclick="closeModal()" style="flex: 1;">
            Cancel
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Toast Container -->
  <div class="toast-container" id="toastContainer"></div>

  <!-- Footer -->
  <footer>
    <div class="container footer-content">
      <div class="logo">
        <i class="fas fa-search-location"></i>
        <div>
          <h2>Back2You</h2>
          <p>College Lost & Found Platform</p>
        </div>
      </div>
      <div class="footer-links">
        <a href="#" class="footer-link" onclick="showQuickGuide()">How It Works</a>
        <a href="#" class="footer-link" onclick="showPrivacyPolicy()">Privacy Policy</a>
        <a href="#" class="footer-link" onclick="showContact()">Contact Us</a>
        <a href="#" class="footer-link" onclick="showAbout()">About</a>
      </div>
      <div class="copyright">
        &copy; 2026 Back2You. College Lost & Found Management System.
      </div>
      <div class="team-name">
        Developed by <strong>Team Nexus</strong>
      </div>
    </div>
  </footer>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage-compat.js"></script>

  <script>
    // Firebase Configuration
    const firebaseConfig = {
      apiKey: "AIzaSyDKy_RM1zrJS2Ux-mrf-ZSAFG3QJGSvm_c",
      authDomain: "back2you-lite-e6695.firebaseapp.com",
      projectId: "back2you-lite-e6695",
      storageBucket: "back2you-lite-e6695.appspot.com"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const auth = firebase.auth();
    const storage = firebase.storage();
    
    // App State
    let currentUser = null;
    let allItems = { lost: [], found: [] };
    let currentEditId = null;
    let currentEditType = null;
    let debounceTimer;
    let stats = { lost: 0, found: 0, matched: 0 };
    let foundFormStep = 1;
    let lostImages = [];
    let foundImages = [];

    // College Locations Suggestions
    const collegeLocationSuggestions = [
      "Physics Lab", "Chemistry Lab", "Biology Lab", "Computer Lab",
      "Library", "Main Building", "Administration Block", "Cafeteria",
      "Auditorium", "Sports Complex", "Parking Lot", "Hostel",
      "Classroom A", "Classroom B", "Classroom C", "Staff Room",
      "College Office", "Park", "Garden", "Playground"
    ];

    // Initialize App
    document.addEventListener('DOMContentLoaded', () => {
      // Set default dates
      const today = new Date().toISOString().split('T')[0];
      document.getElementById('lDate').value = today;
      document.getElementById('fDate').value = today;
      
      // Initialize Firebase Auth
      auth.signInAnonymously()
        .then(() => console.log('Authenticated anonymously'))
        .catch(error => {
          console.error('Authentication error:', error);
          showToast('Authentication failed. Some features may not work.', 'error');
        });
      
      auth.onAuthStateChanged(user => {
        currentUser = user;
        if (user) {
          loadItems();
          updateStats();
        }
      });
      
      // Initialize empty states
      initializeEmptyStates();
      
      // Check for saved dark mode preference
      if (localStorage.getItem('darkMode') === 'true') {
        document.body.classList.add('dark-mode');
        updateDarkModeIcon();
      }
      
      // Set up form navigation
      setupFormNavigation();
      
      // REMOVED: loadDemoData() - No more example data
    });

    // Utility Functions
    function escapeHtml(text) {
      if (!text) return '';
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    function showToast(message, type = 'info', duration = 5000) {
      const container = document.getElementById('toastContainer');
      const toastId = 'toast-' + Date.now();
      
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      toast.id = toastId;
      
      const icons = {
        success: 'fa-check-circle',
        error: 'fa-exclamation-circle',
        info: 'fa-info-circle'
      };
      
      toast.innerHTML = `
        <i class="fas ${icons[type]} toast-icon"></i>
        <div class="toast-message">
          <div class="toast-title">${type.charAt(0).toUpperCase() + type.slice(1)}</div>
          <div>${escapeHtml(message)}</div>
        </div>
        <button class="toast-close" onclick="removeToast('${toastId}')">&times;</button>
      `;
      
      container.appendChild(toast);
      
      // Auto remove after duration
      setTimeout(() => removeToast(toastId), duration);
    }

    function removeToast(id) {
      const toast = document.getElementById(id);
      if (toast) {
        toast.style.animation = 'slideInRight 0.3s ease reverse';
        setTimeout(() => toast.remove(), 300);
      }
    }

    function toggleDarkMode() {
      document.body.classList.toggle('dark-mode');
      localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
      updateDarkModeIcon();
      showToast('Dark mode ' + (document.body.classList.contains('dark-mode') ? 'enabled' : 'disabled'), 'info');
    }

    function updateDarkModeIcon() {
      const icon = document.querySelector('.dark-mode-btn i');
      if (document.body.classList.contains('dark-mode')) {
        icon.classList.remove('fa-moon');
        icon.classList.add('fa-sun');
      } else {
        icon.classList.remove('fa-sun');
        icon.classList.add('fa-moon');
      }
    }

    // Scroll to sections when clicking stats
    function scrollToSection(sectionId) {
      const header = document.querySelector(`#${sectionId}`).previousElementSibling;
      if (header) {
        // Open the section if closed
        const content = document.getElementById(sectionId);
        if (!content.classList.contains('active')) {
          toggleSection(sectionId);
        }
        
        // Scroll to the header
        header.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    }

    function showMatchedItems() {
      // Filter and show only matched items
      const lostContainer = document.getElementById('lostContainer');
      const foundContainer = document.getElementById('foundContainer');
      
      // Open both sections
      if (!lostContainer.classList.contains('active')) {
        toggleSection('lostContainer');
      }
      if (!foundContainer.classList.contains('active')) {
        toggleSection('foundContainer');
      }
      
      // Filter to show only matched items
      filterItems('lost', 'matched');
      filterItems('found', 'matched');
      
      // Scroll to lost section
      scrollToSection('lostContainer');
      
      showToast('Showing matched items only', 'info');
    }

    // Form Navigation
    function showReportForm(formType) {
      // Update active tab
      document.querySelectorAll('.nav-tab').forEach(tab => {
        tab.classList.remove('active');
      });
      document.querySelectorAll('.nav-tab')[formType === 'lost' ? 0 : 1].classList.add('active');
      
      // Show/hide form sections
      document.getElementById('lostFormSection').classList.toggle('active', formType === 'lost');
      document.getElementById('foundFormSection').classList.toggle('active', formType === 'found');
      
      // Reset found form to step 1
      if (formType === 'found') {
        goToStep(1);
      }
    }

    function setupFormNavigation() {
      // Add tab switching with keyboard
      document.addEventListener('keydown', (e) => {
        if (e.ctrlKey && e.key === '1') {
          e.preventDefault();
          showReportForm('lost');
        }
        if (e.ctrlKey && e.key === '2') {
          e.preventDefault();
          showReportForm('found');
        }
      });
    }

    function goToStep(step) {
      // Update step indicators
      document.querySelectorAll('.form-step').forEach((formStep, index) => {
        formStep.classList.remove('active');
        if (index + 1 < step) {
          formStep.classList.add('completed');
        } else {
          formStep.classList.remove('completed');
        }
      });
      document.querySelectorAll('.form-step')[step - 1].classList.add('active');
      
      // Show/hide pages
      document.querySelectorAll('.form-page').forEach((page, index) => {
        page.classList.toggle('active', index + 1 === step);
      });
      
      foundFormStep = step;
    }

    // Image Upload Handling
    function handleLostImageUpload(event) {
      const files = Array.from(event.target.files);
      const previewContainer = document.getElementById('lostImagePreview');
      
      // Clear previous previews
      previewContainer.innerHTML = '';
      
      files.forEach((file, index) => {
        if (file.size > 5 * 1024 * 1024) {
          showToast(`File ${file.name} is too large (max 5MB)`, 'error');
          return;
        }
        
        const reader = new FileReader();
        reader.onload = function(e) {
          const imgSrc = e.target.result;
          lostImages.push(imgSrc);
          
          const preview = document.createElement('div');
          preview.className = 'image-preview';
          preview.innerHTML = `
            <img src="${imgSrc}" alt="Preview ${index + 1}">
            <button type="button" class="remove-image" onclick="removeLostImage(${index})">
              <i class="fas fa-times"></i>
            </button>
          `;
          previewContainer.appendChild(preview);
        };
        reader.readAsDataURL(file);
      });
    }

    function handleFoundImageUpload(event) {
      const files = Array.from(event.target.files);
      const previewContainer = document.getElementById('foundImagePreview');
      
      // Clear previous previews
      previewContainer.innerHTML = '';
      
      files.forEach((file, index) => {
        if (file.size > 5 * 1024 * 1024) {
          showToast(`File ${file.name} is too large (max 5MB)`, 'error');
          return;
        }
        
        const reader = new FileReader();
        reader.onload = function(e) {
          const imgSrc = e.target.result;
          foundImages.push(imgSrc);
          
          const preview = document.createElement('div');
          preview.className = 'image-preview';
          preview.innerHTML = `
            <img src="${imgSrc}" alt="Preview ${index + 1}">
            <button type="button" class="remove-image" onclick="removeFoundImage(${index})">
              <i class="fas fa-times"></i>
            </button>
          `;
          previewContainer.appendChild(preview);
        };
        reader.readAsDataURL(file);
      });
    }

    function removeLostImage(index) {
      lostImages.splice(index, 1);
      updateImagePreview('lost');
    }

    function removeFoundImage(index) {
      foundImages.splice(index, 1);
      updateImagePreview('found');
    }

    function updateImagePreview(type) {
      const previewContainer = document.getElementById(`${type}ImagePreview`);
      const images = type === 'lost' ? lostImages : foundImages;
      
      previewContainer.innerHTML = '';
      
      images.forEach((imgSrc, index) => {
        const preview = document.createElement('div');
        preview.className = 'image-preview';
        preview.innerHTML = `
          <img src="${imgSrc}" alt="Preview ${index + 1}">
          <button type="button" class="remove-image" onclick="remove${type.charAt(0).toUpperCase() + type.slice(1)}Image(${index})">
            <i class="fas fa-times"></i>
          </button>
        `;
        previewContainer.appendChild(preview);
      });
    }

    // Toggle Sections - FIXED
    function toggleSection(sectionId) {
      const section = document.getElementById(sectionId);
      const header = section.previousElementSibling;
      const icon = header.querySelector('.toggle-icon');
      
      // Toggle active class
      section.classList.toggle('active');
      header.classList.toggle('active');
      
      // Rotate icon
      if (section.classList.contains('active')) {
        icon.classList.remove('fa-chevron-down');
        icon.classList.add('fa-chevron-up');
        
        // If opening, ensure content is loaded
        if (sectionId === 'lostContainer' && allItems.lost.length === 0) {
          loadItems();
        } else if (sectionId === 'foundContainer' && allItems.found.length === 0) {
          loadItems();
        }
      } else {
        icon.classList.remove('fa-chevron-up');
        icon.classList.add('fa-chevron-down');
      }
    }

    // Data Management
    async function loadItems() {
      try {
        // Show loading state
        document.getElementById('lostList').innerHTML = '<div class="spinner-container"><div class="spinner"></div></div>';
        document.getElementById('foundList').innerHTML = '<div class="spinner-container"><div class="spinner"></div></div>';
        
        // Load lost items from Firebase
        const lostSnapshot = await db.collection('lostItems').orderBy('timestamp', 'desc').get();
        allItems.lost = lostSnapshot.docs.map(doc => ({
          id: doc.id,
          ...doc.data()
        }));
        
        // Load found items from Firebase
        const foundSnapshot = await db.collection('foundItems').orderBy('timestamp', 'desc').get();
        allItems.found = foundSnapshot.docs.map(doc => ({
          id: doc.id,
          ...doc.data()
        }));
        
        renderLists();
        updateStats();
        
        // Check for potential matches
        checkForMatches();
        
      } catch (error) {
        console.error('Error loading items:', error);
        showToast('Failed to load items. Please refresh the page.', 'error');
        renderLists(); // Still render even if empty
      }
    }

    function renderLists() {
      renderList('lost');
      renderList('found');
    }

    function renderList(type) {
      const container = document.getElementById(`${type}List`);
      const items = allItems[type];
      
      if (items.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <i class="fas fa-${type === 'lost' ? 'exclamation-triangle' : 'check-circle'}"></i>
            <h3>No ${type} items found</h3>
            <p>Be the first to report a ${type} item!</p>
          </div>
        `;
        return;
      }
      
      container.innerHTML = items.map(item => createItemCard(item, type)).join('');
    }

    function createItemCard(item, type) {
      const isLost = type === 'lost';
      const date = new Date(item.date || item.timestamp?.toDate());
      const formattedDate = date.toLocaleDateString('en-US', {
        weekday: 'short',
        year: 'numeric',
        month: 'short',
        day: 'numeric'
      });
      
      const categoryLabels = {
        electronics: 'üì± Electronics',
        documents: 'üìÑ Documents/ID Cards',
        stationery: '‚úèÔ∏è Stationery',
        clothing: 'üëï Clothing',
        keys: 'üîë Keys',
        bag: 'üéí Bag/Backpack',
        books: 'üìö Books/Notebooks',
        other: 'üì¶ Other'
      };
      
      return `
        <div class="item-card ${type} ${item.matched ? 'matched' : ''}" data-id="${item.id}">
          <div class="item-header">
            <h3 class="item-title">${escapeHtml(item.item)}</h3>
            <span class="item-badge badge-${type}">${isLost ? 'LOST' : 'FOUND'}</span>
          </div>
          
          <div class="item-meta">
            <span><i class="fas fa-tag"></i> ${categoryLabels[item.category] || 'üì¶ Other'}</span>
            <span><i class="fas fa-calendar"></i> ${formattedDate}</span>
            ${item.time ? `<span><i class="fas fa-clock"></i> ${item.time}</span>` : ''}
          </div>
          
          ${item.location ? `<p><i class="fas fa-map-marker-alt"></i> ${escapeHtml(item.location)}</p>` : ''}
          
          ${item.description ? `<p>${escapeHtml(item.description)}</p>` : ''}
          
          ${item.color || item.brand ? `
            <div class="item-meta">
              ${item.color ? `<span><i class="fas fa-palette"></i> ${escapeHtml(item.color)}</span>` : ''}
              ${item.brand ? `<span><i class="fas fa-tag"></i> ${escapeHtml(item.brand)}</span>` : ''}
            </div>
          ` : ''}
          
          ${item.imageUrl ? `
            <img src="${item.imageUrl}" alt="${escapeHtml(item.item)}" class="item-image">
          ` : ''}
          
          <div class="item-meta">
            <span><i class="fas fa-user"></i> ${escapeHtml(item.name)}</span>
            <span><i class="fas fa-phone"></i> ${escapeHtml(item.contact)}</span>
          </div>
          
          <div class="item-actions">
            ${!item.matched ? `
              <button class="btn btn-outline btn-icon" onclick="markAsMatched('${type}', '${item.id}')" 
                      title="Mark as Matched">
                <i class="fas fa-handshake"></i>
              </button>
              <button class="btn btn-outline btn-icon" onclick="editItem('${type}', '${item.id}')" 
                      title="Edit Item">
                <i class="fas fa-edit"></i>
              </button>
            ` : ''}
            <button class="btn btn-outline btn-icon" onclick="deleteItem('${type}', '${item.id}')" 
                    title="Delete Item">
              <i class="fas fa-trash"></i>
            </button>
          </div>
          
          ${item.matched ? `
            <div style="margin-top: 10px; padding: 10px; background: rgba(56, 178, 172, 0.1); 
                        border-radius: var(--border-radius-sm); color: var(--secondary-color);">
              <i class="fas fa-check"></i> Successfully matched with owner!
            </div>
          ` : ''}
        </div>
      `;
    }

    function initializeEmptyStates() {
      ['lostList', 'foundList'].forEach(id => {
        const container = document.getElementById(id);
        container.innerHTML = `
          <div class="empty-state">
            <i class="fas fa-spinner fa-spin"></i>
            <h3>Loading items...</h3>
          </div>
        `;
      });
    }

    // Form Handling
    async function handleLostFormSubmit(event) {
      event.preventDefault();
      const form = event.target;
      const submitBtn = form.querySelector('button[type="submit"]');
      
      // Disable button during submission
      const originalText = submitBtn.innerHTML;
      submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
      submitBtn.disabled = true;
      
      try {
        const formData = {
          name: escapeHtml(document.getElementById('lName').value.trim()),
          contact: escapeHtml(document.getElementById('lContact').value.trim()),
          item: escapeHtml(document.getElementById('lItem').value.trim()),
          category: document.getElementById('lCategory').value,
          date: document.getElementById('lDate').value,
          time: document.getElementById('lTime').value,
          location: escapeHtml(document.getElementById('lLoc').value.trim()),
          description: escapeHtml(document.getElementById('lDesc').value.trim()),
          timestamp: firebase.firestore.FieldValue.serverTimestamp(),
          userId: currentUser?.uid || 'anonymous'
        };
        
        // Handle images (in real app, upload to storage)
        if (lostImages.length > 0) {
          // For demo, use the first image as main image
          formData.imageUrl = lostImages[0];
          if (lostImages.length > 1) {
            formData.additionalImages = lostImages.slice(1);
          }
        }
        
        // Save to Firebase
        const docRef = await db.collection('lostItems').add(formData);
        const newId = docRef.id;
        
        // Add to local array for immediate display
        allItems.lost.unshift({ id: newId, ...formData });
        
        // Clear form and images
        form.reset();
        document.getElementById('lDate').valueAsDate = new Date();
        lostImages = [];
        document.getElementById('lostImagePreview').innerHTML = '';
        
        // Reload items and show success message
        renderLists();
        updateStats();
        showToast('Lost item reported successfully! We\'ll notify you if it\'s found.', 'success');
        
        // Auto-expand lost items section
        if (!document.getElementById('lostContainer').classList.contains('active')) {
          toggleSection('lostContainer');
        }
        
      } catch (error) {
        console.error('Error submitting form:', error);
        showToast('Failed to submit form. Please try again.', 'error');
      } finally {
        // Re-enable button
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
      }
    }

    async function handleFoundFormSubmit(event) {
      event.preventDefault();
      const form = event.target;
      const submitBtn = form.querySelector('button[type="submit"]');
      
      // Disable button during submission
      const originalText = submitBtn.innerHTML;
      submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
      submitBtn.disabled = true;
      
      try {
        const formData = {
          name: escapeHtml(document.getElementById('fName').value.trim()),
          contact: escapeHtml(document.getElementById('fContact').value.trim()),
          organization: escapeHtml(document.getElementById('fOrganization').value.trim()),
          item: escapeHtml(document.getElementById('fItem').value.trim()),
          category: document.getElementById('fCategory').value,
          condition: document.getElementById('fCondition').value,
          date: document.getElementById('fDate').value,
          time: document.getElementById('fTime').value,
          location: escapeHtml(document.getElementById('fLoc').value.trim()),
          description: escapeHtml(document.getElementById('fDesc').value.trim()),
          color: escapeHtml(document.getElementById('fColor').value.trim()),
          brand: escapeHtml(document.getElementById('fBrand').value.trim()),
          model: escapeHtml(document.getElementById('fModel').value.trim()),
          storage: document.getElementById('fStorage').value,
          availability: escapeHtml(document.getElementById('fAvailability').value.trim()),
          notes: escapeHtml(document.getElementById('fNotes').value.trim()),
          anonymous: document.getElementById('fAnonymous').checked,
          timestamp: firebase.firestore.FieldValue.serverTimestamp(),
          userId: currentUser?.uid || 'anonymous'
        };
        
        // Handle images
        if (foundImages.length > 0) {
          formData.imageUrl = foundImages[0];
          if (foundImages.length > 1) {
            formData.additionalImages = foundImages.slice(1);
          }
        }
        
        // Save to Firebase
        const docRef = await db.collection('foundItems').add(formData);
        const newId = docRef.id;
        
        // Add to local array for immediate display
        allItems.found.unshift({ id: newId, ...formData });
        
        // Clear form and images
        form.reset();
        document.getElementById('fDate').valueAsDate = new Date();
        foundImages = [];
        document.getElementById('foundImagePreview').innerHTML = '';
        goToStep(1); // Reset to first step
        
        // Reload items and show success message
        renderLists();
        updateStats();
        showToast('Found item reported successfully! Thank you for helping reunite it with its owner.', 'success');
        
        // Auto-expand found items section
        if (!document.getElementById('foundContainer').classList.contains('active')) {
          toggleSection('foundContainer');
        }
        
      } catch (error) {
        console.error('Error submitting form:', error);
        showToast('Failed to submit form. Please try again.', 'error');
      } finally {
        // Re-enable button
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
      }
    }

    // Item Management
    async function deleteItem(type, id) {
      if (!confirm('Are you sure you want to delete this item?')) return;
      
      try {
        // Remove from Firebase
        const dbCollection = type === 'lost' ? 'lostItems' : 'foundItems';
        await db.collection(dbCollection).doc(id).delete();
        
        // Remove from local array
        const collection = type === 'lost' ? allItems.lost : allItems.found;
        const index = collection.findIndex(item => item.id === id);
        if (index !== -1) {
          collection.splice(index, 1);
        }
        
        showToast('Item deleted successfully!', 'success');
        renderLists();
        updateStats();
      } catch (error) {
        console.error('Error deleting item:', error);
        showToast('Failed to delete item.', 'error');
      }
    }

    function editItem(type, id) {
      const items = type === 'lost' ? allItems.lost : allItems.found;
      const item = items.find(i => i.id === id);
      
      if (!item) return;
      
      currentEditId = id;
      currentEditType = type;
      
      // Populate modal
      document.getElementById('editItem').value = item.item;
      document.getElementById('editCategory').value = item.category || 'other';
      document.getElementById('editDate').value = item.date || 
        (item.timestamp?.toDate().toISOString().split('T')[0]);
      document.getElementById('editLocation').value = item.location || '';
      document.getElementById('editDesc').value = item.description || '';
      document.getElementById('editContact').value = item.contact;
      
      // Show modal
      document.getElementById('editModal').style.display = 'flex';
    }

    async function handleEditSubmit(event) {
      event.preventDefault();
      
      try {
        const updatedData = {
          item: escapeHtml(document.getElementById('editItem').value.trim()),
          category: document.getElementById('editCategory').value,
          date: document.getElementById('editDate').value,
          location: escapeHtml(document.getElementById('editLocation').value.trim()),
          description: escapeHtml(document.getElementById('editDesc').value.trim()),
          contact: escapeHtml(document.getElementById('editContact').value.trim()),
          lastUpdated: firebase.firestore.FieldValue.serverTimestamp()
        };
        
        // Update in Firebase
        const dbCollection = currentEditType === 'lost' ? 'lostItems' : 'foundItems';
        await db.collection(dbCollection).doc(currentEditId).update(updatedData);
        
        // Update in local array
        const collection = currentEditType === 'lost' ? allItems.lost : allItems.found;
        const index = collection.findIndex(item => item.id === currentEditId);
        if (index !== -1) {
          collection[index] = { ...collection[index], ...updatedData };
        }
        
        closeModal();
        renderLists();
        showToast('Item updated successfully!', 'success');
      } catch (error) {
        console.error('Error updating item:', error);
        showToast('Failed to update item.', 'error');
      }
    }

    async function markAsMatched(type, id) {
      try {
        const matchedData = {
          matched: true,
          matchedAt: firebase.firestore.FieldValue.serverTimestamp()
        };
        
        // Update in Firebase
        const dbCollection = type === 'lost' ? 'lostItems' : 'foundItems';
        await db.collection(dbCollection).doc(id).update(matchedData);
        
        // Update in local array
        const collection = type === 'lost' ? allItems.lost : allItems.found;
        const item = collection.find(i => i.id === id);
        if (item) {
          item.matched = true;
          item.matchedAt = new Date();
        }
        
        showToast('Item marked as matched!', 'success');
        renderLists();
        updateStats();
      } catch (error) {
        console.error('Error marking as matched:', error);
        showToast('Failed to mark as matched.', 'error');
      }
    }

    // Search and Filter
    function debounceFilter(type) {
      clearTimeout(debounceTimer);
      debounceTimer = setTimeout(() => filterItems(type), 300);
    }

    function filterItems(type, category = null) {
      const searchInput = document.getElementById(`search${type.charAt(0).toUpperCase() + type.slice(1)}`);
      const searchTerm = searchInput.value.toLowerCase();
      
      // Update active filter button
      if (category && event) {
        document.querySelectorAll(`#${type}Container .filter-btn`).forEach(btn => {
          btn.classList.remove('active');
        });
        event.target.classList.add('active');
      }
      
      const items = (type === 'lost' ? allItems.lost : allItems.found).filter(item => {
        // Special case for matched filter
        if (category === 'matched') {
          return item.matched === true;
        }
        
        // Category filter
        if (category && category !== 'all' && item.category !== category) {
          return false;
        }
        
        // Search filter
        if (!searchTerm) return true;
        
        const searchFields = [
          item.item,
          item.category,
          item.location,
          item.description,
          item.name,
          item.color,
          item.brand,
          item.model
        ].filter(Boolean).map(f => f.toLowerCase());
        
        return searchFields.some(field => field.includes(searchTerm));
      });
      
      const container = document.getElementById(`${type}List`);
      if (items.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <i class="fas fa-search"></i>
            <h3>No items found</h3>
            <p>Try adjusting your search or filter criteria</p>
          </div>
        `;
      } else {
        container.innerHTML = items.map(item => createItemCard(item, type)).join('');
      }
    }

    // Match Algorithm
    function checkForMatches() {
      const lostItems = allItems.lost.filter(item => !item.matched);
      const foundItems = allItems.found.filter(item => !item.matched);
      
      let matchesFound = 0;
      
      foundItems.forEach(foundItem => {
        const potentialMatches = lostItems.filter(lostItem => {
          // Enhanced matching algorithm for college items
          const itemSimilarity = compareStrings(foundItem.item, lostItem.item);
          const locationSimilarity = compareStrings(foundItem.location, lostItem.location);
          const categoryMatch = foundItem.category === lostItem.category;
          const colorMatch = foundItem.color && lostItem.color && 
                           compareStrings(foundItem.color, lostItem.color);
          const brandMatch = foundItem.brand && lostItem.brand && 
                           compareStrings(foundItem.brand, lostItem.brand);
          
          // For college, focus more on item description and location
          return (itemSimilarity > 0.7 || (categoryMatch && (colorMatch || brandMatch))) && 
                 (locationSimilarity > 0.5 || foundItem.location === lostItem.location);
        });
        
        if (potentialMatches.length > 0) {
          // For demo, we'll just show a notification
          if (matchesFound === 0) {
            showToast(`Found ${potentialMatches.length} potential match(es) for "${foundItem.item}"`, 'info');
            matchesFound++;
          }
        }
      });
    }

    function compareStrings(str1, str2) {
      if (!str1 || !str2) return 0;
      const s1 = str1.toLowerCase();
      const s2 = str2.toLowerCase();
      
      // Simple similarity check
      if (s1.includes(s2) || s2.includes(s1)) return 1;
      
      // Calculate similarity
      const longer = s1.length > s2.length ? s1 : s2;
      const shorter = s1.length > s2.length ? s2 : s1;
      
      if (longer.length === 0) return 1;
      return (longer.length - longer.split('').filter((c, i) => c !== shorter[i]).length) / longer.length;
    }

    // Stats Management
    function updateStats() {
      stats.lost = allItems.lost.length;
      stats.found = allItems.found.length;
      stats.matched = [...allItems.lost, ...allItems.found].filter(item => item.matched).length;
      
      document.getElementById('lostCount').textContent = stats.lost;
      document.getElementById('foundCount').textContent = stats.found;
      document.getElementById('matchedCount').textContent = stats.matched;
    }

    // Modal Management
    function closeModal() {
      document.getElementById('editModal').style.display = 'none';
      currentEditId = null;
      currentEditType = null;
    }

    // Close modal when clicking outside
    window.onclick = function(event) {
      const modal = document.getElementById('editModal');
      if (event.target === modal) {
        closeModal();
      }
    }

    // Information Modals (Placeholder)
    function showQuickGuide() {
      showToast('Quick Guide: Use tabs to switch between reporting lost or found items. Browse items in expandable sections. Click on stats cards to view specific lists.', 'info', 8000);
    }

    function showPrivacyPolicy() {
      showToast('Privacy Policy: Contact information is only shared between finders and owners. We protect your data.', 'info', 8000);
    }

    function showContact() {
      showToast('Contact: Email: mithunsabari17@gmail.com', 'info', 8000);
    }

    function showAbout() {
      showToast('Back2You: College Lost & Found Management System. Developed by Team Nexus.', 'info', 8000);
    }

    // Keyboard shortcuts
    document.addEventListener('keydown', (e) => {
      // Escape key closes modal
      if (e.key === 'Escape') {
        closeModal();
      }
      
      // Ctrl/Cmd + K focuses search
      if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
        e.preventDefault();
        document.getElementById('searchLost').focus();
      }
      
      // Ctrl/Cmd + D toggles dark mode
      if ((e.ctrlKey || e.metaKey) && e.key === 'd') {
        e.preventDefault();
        toggleDarkMode();
      }
    });
  </script>
</body>
</html>
